(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{563:function(s,t,n){"use strict";n.r(t);var a=n(4),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"minio"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#minio"}},[s._v("#")]),s._v(" MinIO")]),s._v(" "),n("h2",{attrs:{id:"minio-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#minio-2"}},[s._v("#")]),s._v(" MInIO")]),s._v(" "),n("p",[s._v("官方文档描述很详细，可以直接见"),n("a",{attrs:{href:"http://www.minio.org.cn/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网"),n("OutboundLink")],1)]),s._v(" "),n("h2",{attrs:{id:"minio-client"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#minio-client"}},[s._v("#")]),s._v(" MinIO-Client")]),s._v(" "),n("ul",[n("li",[s._v("可以操作Minio、管理多个服务节点。")]),s._v(" "),n("li",[s._v("这里主要记录"),n("strong",[s._v("多用户权限控制")]),s._v("的使用方式")]),s._v(" "),n("li",[s._v("参考"),n("a",{attrs:{href:"http://docs.minio.org.cn/docs/master/minio-client-complete-guide",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),n("OutboundLink")],1)])]),s._v(" "),n("blockquote",[n("p",[s._v("官方最新推出的"),n("a",{attrs:{href:"https://github.com/minio/console",target:"_blank",rel:"noopener noreferrer"}},[s._v("MinIO-Console"),n("OutboundLink")],1),s._v("就是可视化的控制平台")])]),s._v(" "),n("h3",{attrs:{id:"安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载镜像")]),s._v("\ndocker pull minio/mc\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 后台运行")]),s._v("\ndocker run -it --entrypoint"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/bin/sh --name minio-client -d  minio/mc\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入容器")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it minio-client /bin/bash\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 验证")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h3",{attrs:{id:"添加服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#添加服务"}},[s._v("#")]),s._v(" 添加服务")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看当前客户端的配置信息")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("alias")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者直接看配置文件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /root/.mc\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" config.json\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新增配置文件，这里别名就叫yhminio")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" config "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" yhminio http://xx.xx.xx.xx:9000 "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'账户'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'密码'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("alias")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 直接查询，列出yhminio服务的所有bucket，其他操作命令参考文档")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" yhminio\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("blockquote",[n("p",[s._v("默认配置中有MInIO公网的服务：https://play.min.io，可以登录看看，可能需要翻墙访问")]),s._v(" "),n("p",[s._v("账户密码就是"),n("code",[s._v("accessKey")]),s._v("和"),n("code",[s._v("secretKey")]),s._v("的值")])]),s._v(" "),n("h3",{attrs:{id:"自定义权限策略"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#自定义权限策略"}},[s._v("#")]),s._v(" 自定义权限策略")]),s._v(" "),n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Version"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2012-10-17"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Statement"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Effect"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Allow"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Action"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s3:ListAllMyBuckets"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s3:ListBucket"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s3:GetBucketLocation"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s3:GetObject"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s3:PutObject"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s3:DeleteObject"')]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Resource"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"arn:aws:s3:::demo/*"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"arn:aws:s3:::demo2/test*"')]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Condition"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"IpAddress"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"aws:SourceIp"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"203.0.113.0/24"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2001:DB8:1234:5678::/64"')]),s._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br")])]),n("ul",[n("li",[n("strong",[s._v("Version")]),s._v(" 值是固定"),n("code",[s._v("2012-10-17")]),s._v("，不要修改")]),s._v(" "),n("li",[n("strong",[s._v("Effect")]),s._v(" 就两种：拒绝"),n("code",[s._v("Deny")]),s._v("、允许"),n("code",[s._v("Allow")])]),s._v(" "),n("li",[n("strong",[s._v("Action")]),s._v(" 这里列出的几种常用的，"),n("a",{attrs:{href:"http://docs.minio.org.cn/minio/baremetal/security/minio-identity-management/policy-based-access-control.html#minio-policy-actions",target:"_blank",rel:"noopener noreferrer"}},[s._v("更多参考文档S3 Policy"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("strong",[s._v("Resource")]),s._v(" 列出需要控制的"),n("strong",[s._v("bucket")]),s._v("，或下面的某个目录")]),s._v(" "),n("li",[n("strong",[s._v("Condition")]),s._v(" 条件触发，比如条件"),n("code",[s._v("IpAddress")]),s._v("和条件对应Key值"),n("code",[s._v("aws:SourceIp")]),s._v("，"),n("a",{attrs:{href:"http://docs.minio.org.cn/minio/baremetal/security/minio-identity-management/policy-based-access-control.html#minio-policy-conditions",target:"_blank",rel:"noopener noreferrer"}},[s._v("更多参考文档"),n("OutboundLink")],1)])]),s._v(" "),n("h3",{attrs:{id:"新增用户、组"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#新增用户、组"}},[s._v("#")]),s._v(" 新增用户、组")]),s._v(" "),n("p",[s._v("针对某用户权限的话，先创建个用户。")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新增用户demouser，密码demo1234 到 yhminio。注意密码至少8位")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" admin user "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" yhminio demouser demo1234\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看，看不到初始化管理员账户的")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" admin user list yhminio\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看信息")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" admin user info yhminio demouser\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用户启用")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" admin user "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" yhminio demouser\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用户禁用")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" admin user disable yhminio demouser\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除用户")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" admin user remove yhminio demouser\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("blockquote",[n("p",[s._v("组的命令类似，把user换成group，"),n("a",{attrs:{href:"http://docs.minio.org.cn/docs/master/minio-admin-complete-guide",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考文档"),n("OutboundLink")],1)])]),s._v(" "),n("h3",{attrs:{id:"添加权限策略"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#添加权限策略"}},[s._v("#")]),s._v(" 添加权限策略")]),s._v(" "),n("blockquote",[n("p",[s._v("操作基于"),n("code",[s._v("mc admin")]),s._v("的"),n("code",[s._v("policy")]),s._v("、"),n("code",[s._v("user")]),s._v("命令，"),n("a",{attrs:{href:"http://docs.minio.org.cn/docs/master/minio-admin-complete-guide",target:"_blank",rel:"noopener noreferrer"}},[s._v("更多参考文档"),n("OutboundLink")],1)])]),s._v(" "),n("p",[s._v("首先根据需求创建一个自定义权限策略文件，假设叫"),n("code",[s._v("demoPolicy.json")])]),s._v(" "),n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Version"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2012-10-17"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Statement"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Effect"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Allow"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Action"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s3:ListAllMyBuckets"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s3:ListBucket"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s3:GetBucketLocation"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s3:GetObject"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s3:PutObject"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s3:DeleteObject"')]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Resource"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"arn:aws:s3:::demo/*"')]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])]),n("p",[s._v("默认都有4种策略值："),n("code",[s._v("diagnostics、readonly、readwrite、writeonly")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 minio 的当前策略，策略可针对每一级目录")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" admin policy list yhminio\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" admin policy list yhminio/demo\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" admin policy list yhminio/demo/test\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将demoPolicy.json 先复制到容器中某个目录，这里mc目录记得先创建")]),s._v("\ndocker container "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /yh/soft/minio/demoPolicy.json minio-client:/mc\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 容器内，策略文件路径")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -l /mc\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 映射策略文件，直接赋值给minio，这里别名叫demoonly。映射后源文件删除不影响")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" admin policy "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" yhminio demoonly /mc/demoPolicy.json \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 再次查看就有5种了")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" admin policy list yhminio\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看策略信息")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" admin policy info yhminio demoonly\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除策略")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" admin policy remove yhminio demoonly\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])]),n("p",[s._v("新用户是没有策略权限的，需要映射，且只能一种，这里"),n("code",[s._v("demouser")]),s._v("是上面刚创建的用户")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# set 命令映射策略给一个用户或一个组")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将上面创建的demoonly策略映射给demouser用户")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mc")]),s._v(" admin policy "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" yhminio demoonly "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("user")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("demouser\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 再赋值另一种策略，会覆盖")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"登录验证"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#登录验证"}},[s._v("#")]),s._v(" 登录验证")]),s._v(" "),n("p",[s._v("再次登录"),n("code",[s._v("demouesr")]),s._v("用户，就只可看见"),n("code",[s._v("demo")]),s._v("的"),n("strong",[s._v("bucket")])])])}),[],!1,null,null,null);t.default=e.exports}}]);