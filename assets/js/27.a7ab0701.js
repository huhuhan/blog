(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{526:function(t,s,a){"use strict";a.r(s);var n=a(4),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"agilebpm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#agilebpm"}},[t._v("#")]),t._v(" AgileBPM")]),t._v(" "),a("h3",{attrs:{id:"源项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#源项目"}},[t._v("#")]),t._v(" 源项目")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"http://www.agilebpm.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("开源项目"),a("OutboundLink")],1),t._v("，于2019年停止维护，区分商业版"),a("a",{attrs:{href:"http://www.agilebpm.cn/zh-cn/releaseNote/CommercialVersionComparison.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("对比参考"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("流程引擎基于"),a("code",[t._v("Activiti-5.22")]),t._v("版本开发")]),t._v(" "),a("li",[t._v("Maven模块化结构，其中流程模块，相关代码未提供，jar是代码混淆过的")]),t._v(" "),a("li",[t._v("区别原生流程引擎，是通过流程引擎的事件进行操作，将操作记录在扩展的自定义表中")])]),t._v(" "),a("h3",{attrs:{id:"二次开发"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二次开发"}},[t._v("#")]),t._v(" 二次开发")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("开源版，将核心模块（wf）代码反编译，并梳理逻辑重构，解决代码混淆问题")])]),t._v(" "),a("li",[a("p",[t._v("项目重构为SpringBoot版本")])]),t._v(" "),a("li",[a("p",[t._v("功能扩展和修复，实现部分商业版功能")]),t._v(" "),a("ul",[a("li",[t._v("流程表单：支持Vue表单、插件窗口Vue组件化")]),t._v(" "),a("li",[t._v("流程插件：催办、自由跳转、自由驳回、撤销、终止、转办、抄送")]),t._v(" "),a("li",[t._v("流程模型：导入导出")]),t._v(" "),a("li",[t._v("异常修复：流程实例丢件（开源版BUG），支持找回再自由配置（通过自由跳转实现）")])])]),t._v(" "),a("li",[a("p",[t._v("支持代码混淆，同样通过"),a("code",[t._v("proguard")]),t._v("实现构建混淆，源码暂不开放")])]),t._v(" "),a("li",[a("p",[t._v("重构，"),a("a",{attrs:{href:"https://github.com/huhuhan/yh-cloud-ui",target:"_blank",rel:"noopener noreferrer"}},[t._v("分离式VUE前端项目"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[t._v("重构，"),a("a",{attrs:{href:"https://github.com/huhuhan/bpm",target:"_blank",rel:"noopener noreferrer"}},[t._v("扩展功能的后端项目"),a("OutboundLink")],1)])])]),t._v(" "),a("h2",{attrs:{id:"项目分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#项目分析"}},[t._v("#")]),t._v(" 项目分析")]),t._v(" "),a("h3",{attrs:{id:"mybatis调用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mybatis调用"}},[t._v("#")]),t._v(" Mybatis调用")]),t._v(" "),a("p",[t._v("Agile是采用原生Mybatis开发的，即源码的"),a("code",[t._v("base-db")]),t._v("模块。相对常用的Myabtis-plus等第三方组件，可能没有一些通用方法，需要自己实现。")]),t._v(" "),a("p",[t._v("定义了一套通用的增删改差的基类：")]),t._v(" "),a("ul",[a("li",[t._v("Controller层："),a("code",[t._v("BaseController")]),t._v("和"),a("code",[t._v("ControllerTools")])]),t._v(" "),a("li",[t._v("Service接口："),a("code",[t._v("Manager")])])]),t._v(" "),a("h3",{attrs:{id:"流程设计器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#流程设计器"}},[t._v("#")]),t._v(" 流程设计器")]),t._v(" "),a("p",[t._v("Agile将Activiti自带的流程设计器，通过"),a("code",[t._v("AngularJS")]),t._v("扩展一些交互窗口了，将流程配置交互更方面了，如图")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://fastly.jsdelivr.net/gh/huhuhan/img@master/md/pic/20210706160344.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("这也是我看中的原因，原生自带的交互不好用，比如都是输入框，而不是下拉选择框。对AngularJS熟悉度不高，所以流程设计器前端这块仅针对接口的调用作了修改。")])]),t._v(" "),a("h3",{attrs:{id:"设计思路"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设计思路"}},[t._v("#")]),t._v(" 设计思路")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("监听器接口设计")]),t._v(" "),a("ol",[a("li",[t._v("全局事件监听器接口：根据监听acitivit引擎的操作事件来触发自定义事件")]),t._v(" "),a("li",[t._v("抽象监听器接口\n"),a("ul",[a("li",[t._v("流程实例抽象类\n"),a("ul",[a("li",[t._v("实例创建")]),t._v(" "),a("li",[t._v("实例结束")])])]),t._v(" "),a("li",[t._v("流程任务抽象类\n"),a("ul",[a("li",[t._v("任务创建")]),t._v(" "),a("li",[t._v("任务结束")])])]),t._v(" "),a("li",[t._v("流程发起")]),t._v(" "),a("li",[t._v("流程完成")]),t._v(" "),a("li",[t._v("流程取消")]),t._v(" "),a("li",[t._v("连线创建")]),t._v(" "),a("li",[t._v("定时执行")])])])]),t._v(" "),a("details",{staticClass:"custom-block details"},[a("summary",[t._v("【示例】任务抽象类，定义任务的执行流程")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("notify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ActivitiEvent")]),t._v(" event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ActivitiEntityEvent")]),t._v(" entityEvent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ActivitiEntityEvent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TaskEntity")]),t._v(" taskEntity "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TaskEntity")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" entityEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getEntity")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// TaskEntity对象转为DefaultTaskActionCmd")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),t._v(" model "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getActionModel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("taskEntity"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 执行前置插件之前")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("beforePluginExecute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 触发前置插件")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBeforeTriggerEventType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("taskCommand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("execute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBeforeTriggerEventType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 触发具体事件操作")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("triggerExecute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 触发后置插件")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAfterTriggerEventType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("taskCommand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("execute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAfterTriggerEventType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 执行后置插件之后")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("afterPluginExecute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br")])])])]),t._v(" "),a("li",[a("p",[t._v("脚本接口设计")]),t._v(" "),a("ul",[a("li",[t._v("流程任务脚本接口")]),t._v(" "),a("li",[t._v("流程实例脚本接口")]),t._v(" "),a("li",[t._v("脚本执行接口")]),t._v(" "),a("li",[t._v("基础脚本抽象类")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://fastly.jsdelivr.net/gh/huhuhan/img@master/md/pic/20210304144541.png",alt:""}})])]),t._v(" "),a("li",[a("p",[t._v("脚本执行接口")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://fastly.jsdelivr.net/gh/huhuhan/img@master/md/pic/20210304145615.png",alt:""}})])]),t._v(" "),a("li",[a("p",[t._v("流程实例抽象类：实现类都是流程实例的脚本操作")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://fastly.jsdelivr.net/gh/huhuhan/img@master/md/pic/20210304145733.png",alt:""}})])]),t._v(" "),a("li",[a("p",[t._v("流程任务抽象类：实现类都是流程任务的脚本操作")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://fastly.jsdelivr.net/gh/huhuhan/img@master/md/pic/20210304150018.png",alt:""}})])])]),t._v(" "),a("h3",{attrs:{id:"源码分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#源码分析"}},[t._v("#")]),t._v(" 源码分析")]),t._v(" "),a("h4",{attrs:{id:"actionhandler"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#actionhandler"}},[t._v("#")]),t._v(" ActionHandler")]),t._v(" "),a("p",[t._v("例子接口："),a("strong",[t._v("/bpm/task/doAction")])]),t._v(" "),a("ul",[a("li",[a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("1、根据参数创建DefualtTaskActionCmd：taskModel\n2、taskModel执行抽象方法taskModel.executeCmd()\n3、抽象方法executeCmd根据ActionType获取ActionHandler接口\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])]),t._v(" "),a("li",[a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("重点1：AbsActionHandler抽象方法execute()，加事务\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("ol",[a("li",[a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// 初始化数据：包括初始化数据脚本、业务表单数据\nprepareActionDatas(model);\nTask：子抽象类，实现\nInstance：保存、催办、人工终止\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])])]),t._v(" "),a("li",[a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// 验证流程是否有效\ncheckFlowIsValid(model);\n当前类，实现\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])]),t._v(" "),a("li",[a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// 本地线程池，设置流程栈\nBpmContext.setActionModel(model);\n工具类，实现\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])]),t._v(" "),a("li",[a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// 处理业务表单数据\nhandelBusData(model);\n当前类，实现\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("ul",[a("li",[a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("executeHandler\n当前类，实现，URL表单处理器的调用\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])])]),t._v(" "),a("li",[a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// 前置事件，重点\ndoActionBefore(model)\n由事件决定\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])])])]),t._v(" "),a("li",[a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// 具体脚本操作，重点\ndoAction(model);\nTask：子抽象类，实现、保存\nInstance：保存、催办、发起、人工终止\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])])]),t._v(" "),a("li",[a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// 跳过doSkip(model);\n当前类，实现\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])])]),t._v(" "),a("li",[a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// 删除本地线程池\nBpmContext.removeActionModel();\n工具类，实现\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])]),t._v(" "),a("li",[a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// 后置事件\nactionAfter(model);\n重点：同前置事件，如上\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("重点2：抽象子类AbstractTaskActionHandler，以上8中，其中\nprepareActionDatas\ndoAction、\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])])]),t._v(" "),a("h4",{attrs:{id:"activitieventlistener"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#activitieventlistener"}},[t._v("#")]),t._v(" ActivitiEventListener")]),t._v(" "),a("p",[t._v("监听"),a("strong",[t._v("Activiti流程引擎")]),t._v("原始的事件，扩展操作，关键类"),a("strong",[t._v("GlobalEventListener")])]),t._v(" "),a("ul",[a("li",[a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("AbBpmAutoConfiguration\n\t// 关键，初始化Activiti流程事件\n    @Bean\n    public GlobalEventListener globalEventListener() {\n    ...\n    }\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("收到监听，只要是初始化的事件，就触发通知")])])]),t._v(" "),a("h4",{attrs:{id:"applicationlistener"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#applicationlistener"}},[t._v("#")]),t._v(" ApplicationListener")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v("AbstractMessageQueue implements ApplicationListener<ContextRefreshedEvent>\n\n抽象公告消息队列，实现ApplicationListener<ContextRefreshedEvent>接口\n\tonApplicationEvent():注册消息处理器接口，实现类的Map集合，存储内存中\n\t\t并提供初始化接口实例的后置方法\n\t\t注册实现类如下：\n\t\t\t1、同步队列，即生产立马消费，生产者=消费者\n\t\t\t2、Redis队列，生产者，以数组存储，消费者开启线程消费该数组对象。\n\t\t\t\t\t线程通过初始化接口实例的后置方式开启\n\t\t\t3、通用队列，基于MQ实现\n\t\t\t\t\t生产者通过JmsTemplate发送至MQ\n\t\t\t\t\t消费者消费，消费初始化配置MQ连接\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);