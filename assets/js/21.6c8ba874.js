(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{519:function(s,a,n){"use strict";n.r(a);var t=n(4),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("blockquote",[n("p",[n("a",{attrs:{href:"https://github.com/huhuhan/demo-docker",target:"_blank",rel:"noopener noreferrer"}},[s._v("更多案例的配置文件，进入仓库查找"),n("OutboundLink")],1)])]),s._v(" "),n("h2",{attrs:{id:"dockerfile"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[s._v("#")]),s._v(" Dockerfile")]),s._v(" "),n("h3",{attrs:{id:"springboot-openjdk"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#springboot-openjdk"}},[s._v("#")]),s._v(" springBoot + openjdk")]),s._v(" "),n("div",{staticClass:"language-dockerfile line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 基础镜像，使用alpine操作系统，openjkd使用8-jdk-alpine")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" openjdk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("jdk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("alpine\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置 镜像仓库")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" echo "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://mirrors.aliyun.com/alpine/v3.6/main/\\n\\\nhttps://mirrors.aliyun.com/alpine/v3.6/community"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v(" /etc/apk/repositories\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装字体软件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" apk "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("update add ttf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("dejavu && rm "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("rf /var/cache/apk/*\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置时间")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" echo "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Asia/Shanghai"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v("etc/timezone && \\\n        ln "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 系统编码")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" LANG zh_CN.UTF"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("8\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" LANGUAGE zh_CN"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("zh\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" LC_ALL zh_CN.UTF"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("8\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" PARAMS="),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加jar包")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" target/my"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("springboot.jar app.jar\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加本地字体文件夹, 如宋体")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" font /usr/share/fonts/chinese\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动容器时的进程")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENTRYPOINT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"java"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-jar"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/app.jar"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 参数自定义")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#ENTRYPOINT ["sh", "-c", "java", "-jar", "$JAVA_OPTS", "ureport.jar", "$PARAMS"]')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定配置，配置文件需挂载")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#ENTRYPOINT ["java","-jar","/app.jar","--spring.config.location=/opt/bpm/config/prod-82.yml"]')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定配置环境变量")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#ENTRYPOINT ["java","-jar","/app.jar","--spring.profiles.active=prod"]')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#暴露端口")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 8866\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br")])]),n("h3",{attrs:{id:"dist-nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dist-nginx"}},[s._v("#")]),s._v(" dist + nginx")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# 忽略所有\n* \n# 除了以下目录\n!dist/\n!docker/\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("div",{staticClass:"language-dockerfile line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置基础镜像")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("alpine\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将dist静态文件中的内容复制到 /usr/share/nginx/html/ 这个目录下面")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" dist/  /usr/share/nginx/html/\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#用本地的 nginx.conf 配置来替换nginx镜像里的默认配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" docker/nginx.conf /etc/nginx/nginx.conf\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nginx配置的服务器端口，默认80")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#EXPOSE 8700")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h3",{attrs:{id:"vue-node"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue-node"}},[s._v("#")]),s._v(" vue + node")]),s._v(" "),n("div",{staticClass:"language-dockerfile line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" node"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("alpine\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将当前目录下的所有文件（除了`.dockerignore`排除的路径），都拷贝进入 image 文件的`/app`目录。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" . /app\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定接下来的工作路径为`/app`")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /app\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在`/app`目录下，运行`npm install`命令安装依赖。注意，安装后所有的依赖，都将打包进入 image 文件。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" npm install "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("registry=https"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//registry.npm.taobao.org\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 3000\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h3",{attrs:{id:"web-node-nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#web-node-nginx"}},[s._v("#")]),s._v(" web + node + nginx")]),s._v(" "),n("p",[n("strong",[s._v("多成构建")])]),s._v(" "),n("ul",[n("li",[s._v("每条命令代表一个步骤Step。docker内部作为一层，会缓存。")]),s._v(" "),n("li",[s._v("重复构建，相同命令采用缓存构建，构建速度会很快。")]),s._v(" "),n("li",[s._v("因此将package.json先拷贝安装依赖，只要package.json没变化，就采用缓存构建。")]),s._v(" "),n("li",[s._v("一个FROM生成一个镜像，因此第一个是为"),n("code",[s._v("<none>")]),s._v("的缓存镜像，第二个才是最终镜像")])]),s._v(" "),n("h4",{attrs:{id:"缓存package"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#缓存package"}},[s._v("#")]),s._v(" 缓存package")]),s._v(" "),n("div",{staticClass:"language-dockerfile line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# node镜像")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" node"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("alpine as build"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("stage\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定接下来的工作路径为/app  - 类似于cd命令")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /app\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 拷贝前端项目到app目录下")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" . .\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置淘宝npm镜像")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" npm install "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("g cnpm "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("registry=https"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//registry.npm.taobao.org\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装依赖")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" cnpm install\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打包 - 目的：丢到nginx下跑")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" cnpm run build\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ======================== 上：npm打包  下：nginx运行 ========================")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nginx镜像")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("alpine as production"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("stage\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 把主机的nginx.conf文件复制到nginx容器的/etc/nginx文件夹下")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" ./docker/nginx.conf /etc/nginx/nginx.conf\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 拷贝前端vue项目打包后生成的文件到nginx下运行")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("from=build"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("stage /app/dist /usr/share/nginx/html\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注：CMD不同于RUN，CMD用于指定在容器启动时所要执行的命令，而RUN用于指定镜像构建时所要执行的命令。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    RUN指令创建的中间镜像会被缓存，并会在下次构建中使用。如果不想使用这些缓存镜像，可以在构建时指定--no-cache参数，如：docker build --no-cache")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用daemon off的方式将nginx运行在前台保证镜像不至于退出")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-g"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"daemon off;"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br")])]),n("p",[s._v("重复执行采用缓存，快速构建\n"),n("img",{attrs:{src:"https://fastly.jsdelivr.net/gh/huhuhan/img@master/md/docker/docker-cache-1.png",alt:""}}),s._v("\n更新package.json，只用重新构建install层和后续命令（Copy等命令仍采用缓存）\n"),n("img",{attrs:{src:"https://fastly.jsdelivr.net/gh/huhuhan/img@master/md/docker/docker-cache-2.png",alt:""}})]),s._v(" "),n("h4",{attrs:{id:"无缓存"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#无缓存"}},[s._v("#")]),s._v(" 无缓存")]),s._v(" "),n("div",{staticClass:"language-dockerfile line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# node镜像")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" node"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("alpine as build"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("stage\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定接下来的工作路径为/app  - 类似于cd命令")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /app\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#先拷贝安装依赖文件，再拷贝项目")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" ./package"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("lock.json .\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" ./package.json .\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置淘宝npm镜像")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" npm install "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("registry=https"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//registry.npm.taobao.org\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 安装依赖")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#RUN cnpm install")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 拷贝前端项目到app目录下")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" . .\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打包 - 目的：丢到nginx下跑")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" npm run build\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ======================== 上：npm打包  下：nginx运行 ========================")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nginx镜像")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("alpine as production"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("stage\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 把主机的nginx.conf文件复制到nginx容器的/etc/nginx文件夹下")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" ./docker/nginx.conf /etc/nginx/nginx.conf\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 拷贝前端vue项目打包后生成的文件到nginx下运行")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("from=build"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("stage /app/dist /usr/share/nginx/html\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注：CMD不同于RUN，CMD用于指定在容器启动时所要执行的命令，而RUN用于指定镜像构建时所要执行的命令。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    RUN指令创建的中间镜像会被缓存，并会在下次构建中使用。如果不想使用这些缓存镜像，可以在构建时指定--no-cache参数，如：docker build --no-cache")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用daemon off的方式将nginx运行在前台保证镜像不至于退出")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-g"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"daemon off;"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br")])]),n("h2",{attrs:{id:"docker-compose"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose"}},[s._v("#")]),s._v(" Docker-Compose")]),s._v(" "),n("h3",{attrs:{id:"mysql-wordpress"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mysql-wordpress"}},[s._v("#")]),s._v(" mysql + wordpress")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mysql")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n       "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" MYSQL_ROOT_PASSWORD=123456\n       "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" MYSQL_DATABASE=wordpress\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" wordpress\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("links")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n       "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" mysql\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n       "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" WORDPRESS_DB_PASSWORD=123456\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n       "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8500:80"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("working_dir")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" /var/www/html\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n       "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" wordpress"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/var/www/html\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("h3",{attrs:{id:"tomcat-webapp"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#tomcat-webapp"}},[s._v("#")]),s._v(" tomcat + webapp")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("rdp")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" tomcat\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" rdp\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 9800"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 实际绝对路径（若写相对路径前缀$pwd）")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" D"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\\YH\\test\\docker\\hs\\rdp\\data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/usr/local/tomcat/data\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" D"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\\YH\\test\\docker\\hs\\rdp\\webapps"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/usr/local/tomcat/webapps\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h3",{attrs:{id:"kafka-zookeeper"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#kafka-zookeeper"}},[s._v("#")]),s._v(" kafka + zookeeper")]),s._v(" "),n("div",{staticClass:"language-yml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3.1'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("zookeeper1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" wurstmeister/zookeeper\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kafka"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("zookeeper1\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hostname")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" zookeeper1\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 2181"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2181")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ZOO_MY_ID")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ZOO_SERVERS: server.1=0.0.0.0:2888:3888 server.2=zookeeper2:2888:3888 server.3=zookeeper3:2888:3888")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# zookeeper2:")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# image: zookeeper")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# container_name: kafka-zookeeper2")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# restart: always")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# hostname: zookeeper2")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ports:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - 2182:2181")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# environment:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ZOO_MY_ID: 2")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ZOO_SERVERS: server.1=zookeeper1:2888:3888 server.2=0.0.0.0:2888:3888 server.3=zookeeper3:2888:3888")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# zookeeper3:")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# image: zookeeper")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# container_name: kafka-zookeeper3")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# restart: always")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# hostname: zookeeper3")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ports:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - 2183:2181")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# environment:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ZOO_MY_ID: 3")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ZOO_SERVERS: server.1=zookeeper1:2888:3888 server.2=zookeeper2:2888:3888 server.3=0.0.0.0:2888:3888")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kafka1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" wurstmeister/kafka\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kafka"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("kafka1\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"9092:9092"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1099:1099"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" zookeeper1\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - zookeeper2")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - zookeeper3")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 集群中唯一ID，节点ID")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("KAFKA_BROKER_ID")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 宿主机ip，集群的话不要用localhost或127.0.0.1")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("KAFKA_ADVERTISED_HOST_NAME")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 192.168.0.137\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# zookeeper链接地址，多个用逗号区分")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("KAFKA_ZOOKEEPER_CONNECT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" zookeeper1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2181")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#,zookeeper2:2181,zookeeper3:2181")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 端口，给监控工具获取集群使用，比如kafka-manager")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("CUSTOM_JMX_PORT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1099"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 内存配置")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("JVM_XMS")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"256M"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("JVM_XMX")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"512M"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# volumes:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# # window版不支持docker.sock  ")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - /var/run/docker.sock:/var/run/docker.sock")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# # 磁盘挂载broker数据")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - /home/work/data/kafka1:/kafka")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kafka2:")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# image: xuxiangwork/kafka")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# container_name: kafka-kafka2")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ports:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# - "9093:9092"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# - "1100:1100"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# depends_on:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - zookeeper1")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - zookeeper2")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - zookeeper3")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# environment:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# KAFKA_BROKER_ID: 2")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# KAFKA_ADVERTISED_HOST_NAME: you_ip_addr(like 192.168.14.10)")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# KAFKA_ZOOKEEPER_CONNECT: zookeeper1:2181,zookeeper2:2181,zookeeper3:2181")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# CUSTOM_JMX_PORT: "1100"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# JVM_XMS: "256M"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# JVM_XMX: "512M"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# volumes:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - /var/run/docker.sock:/var/run/docker.sock")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - /home/work/data/kafka2:/kafka")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# restart: always")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kafka3:")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# image: xuxiangwork/kafka")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# container_name: kafka-kafka3")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ports:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# - "9094:9092"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# - "1101:1101"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# depends_on:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - zookeeper1")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - zookeeper2")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - zookeeper3")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# environment:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# KAFKA_BROKER_ID: 3")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# KAFKA_ADVERTISED_HOST_NAME: you_ip_addr(like 192.168.14.10)")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# KAFKA_ZOOKEEPER_CONNECT: zookeeper1:2181,zookeeper2:2181,zookeeper3:2181")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# CUSTOM_JMX_PORT: "1101"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# JVM_XMS: "256M"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# JVM_XMX: "512M"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# volumes:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - /var/run/docker.sock:/var/run/docker.sock")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - /home/work/data/kafka3:/kafka")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# restart: always")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kafka4:")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# image: xuxiangwork/kafka")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# container_name: kafka-kafka4")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ports:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# - "9095:9092"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# - "1102:1102"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# depends_on:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - zookeeper1")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - zookeeper2")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - zookeeper3")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# environment:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# KAFKA_BROKER_ID: 4")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# KAFKA_ADVERTISED_HOST_NAME: you_ip_addr(like 192.168.14.10)")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# KAFKA_ZOOKEEPER_CONNECT: zookeeper1:2181,zookeeper2:2181,zookeeper3:2181")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# CUSTOM_JMX_PORT: "1102"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# JVM_XMS: "256M"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# JVM_XMX: "512M"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# volumes:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - /var/run/docker.sock:/var/run/docker.sock")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - /home/work/data/kafka4:/kafka")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# restart: always")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kafka5:")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# image: xuxiangwork/kafka")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# container_name: kafka-kafka5")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ports:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# - "9096:9092"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# - "1103:1103"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# depends_on:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - zookeeper1")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - zookeeper2")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - zookeeper3")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# environment:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# KAFKA_BROKER_ID: 5")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# KAFKA_ADVERTISED_HOST_NAME: you_ip_addr(like 192.168.14.10)")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# KAFKA_ZOOKEEPER_CONNECT: zookeeper1:2181,zookeeper2:2181,zookeeper3:2181")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# CUSTOM_JMX_PORT: "1103"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# JVM_XMS: "256M"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# JVM_XMX: "512M"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# volumes:")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - /var/run/docker.sock:/var/run/docker.sock")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - /home/work/data/kafka5:/kafka")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# restart: always")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kafka-manager")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" sheepkiller/kafka"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("manager\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kafka"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("manager\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"9000:9000"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" zookeeper1\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ZK_HOSTS")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" zookeeper1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2181")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("APPLICATION_SECRET")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" letmein\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("KM_ARGS")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("Djava.net.preferIPv4Stack=true\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br"),n("span",{staticClass:"line-number"},[s._v("121")]),n("br"),n("span",{staticClass:"line-number"},[s._v("122")]),n("br"),n("span",{staticClass:"line-number"},[s._v("123")]),n("br"),n("span",{staticClass:"line-number"},[s._v("124")]),n("br"),n("span",{staticClass:"line-number"},[s._v("125")]),n("br"),n("span",{staticClass:"line-number"},[s._v("126")]),n("br"),n("span",{staticClass:"line-number"},[s._v("127")]),n("br"),n("span",{staticClass:"line-number"},[s._v("128")]),n("br"),n("span",{staticClass:"line-number"},[s._v("129")]),n("br"),n("span",{staticClass:"line-number"},[s._v("130")]),n("br"),n("span",{staticClass:"line-number"},[s._v("131")]),n("br"),n("span",{staticClass:"line-number"},[s._v("132")]),n("br"),n("span",{staticClass:"line-number"},[s._v("133")]),n("br"),n("span",{staticClass:"line-number"},[s._v("134")]),n("br"),n("span",{staticClass:"line-number"},[s._v("135")]),n("br"),n("span",{staticClass:"line-number"},[s._v("136")]),n("br"),n("span",{staticClass:"line-number"},[s._v("137")]),n("br"),n("span",{staticClass:"line-number"},[s._v("138")]),n("br"),n("span",{staticClass:"line-number"},[s._v("139")]),n("br"),n("span",{staticClass:"line-number"},[s._v("140")]),n("br"),n("span",{staticClass:"line-number"},[s._v("141")]),n("br"),n("span",{staticClass:"line-number"},[s._v("142")]),n("br"),n("span",{staticClass:"line-number"},[s._v("143")]),n("br"),n("span",{staticClass:"line-number"},[s._v("144")]),n("br"),n("span",{staticClass:"line-number"},[s._v("145")]),n("br"),n("span",{staticClass:"line-number"},[s._v("146")]),n("br"),n("span",{staticClass:"line-number"},[s._v("147")]),n("br"),n("span",{staticClass:"line-number"},[s._v("148")]),n("br"),n("span",{staticClass:"line-number"},[s._v("149")]),n("br"),n("span",{staticClass:"line-number"},[s._v("150")]),n("br"),n("span",{staticClass:"line-number"},[s._v("151")]),n("br"),n("span",{staticClass:"line-number"},[s._v("152")]),n("br"),n("span",{staticClass:"line-number"},[s._v("153")]),n("br"),n("span",{staticClass:"line-number"},[s._v("154")]),n("br"),n("span",{staticClass:"line-number"},[s._v("155")]),n("br")])]),n("h3",{attrs:{id:"springcloud"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#springcloud"}},[s._v("#")]),s._v(" springcloud")]),s._v(" "),n("blockquote",[n("ul",[n("li",[s._v("同一docker网络："),n("a",{attrs:{href:"https://www.cnblogs.com/jsonhc/p/7823286.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考博客"),n("OutboundLink")],1),s._v("、"),n("a",{attrs:{href:"https://github.com/huhuhan/demo-all/tree/master/demo-sc",target:"_blank",rel:"noopener noreferrer"}},[s._v("微服务实例"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("同一docker网络版本要求："),n("strong",[s._v("1.19版本+")]),s._v("，"),n("a",{attrs:{href:"https://stackoverflow.com/questions/33639138/docker-networking-nginx-emerg-host-not-found-in-upstream?r=SearchResults",target:"_blank",rel:"noopener noreferrer"}},[s._v("问题参考"),n("OutboundLink")],1)])])]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置同一网络")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("toilet")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("driver")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" bridge\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("toilet-eureka")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" toilet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("eureka\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" toilet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("eureka\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("context")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ./\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dockerfile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Dockerfile"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("eureka\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("TZ")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Asia/Shanghai\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 内部端口映射不用动")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 8761"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8761")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" toilet\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("toilet-gateway")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" toilet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("gateway\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" toilet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("gateway\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("context")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ./\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dockerfile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Dockerfile"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("gateway\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("TZ")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Asia/Shanghai\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 9000"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" toilet\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("toilet-auth")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" toilet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("auth\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" toilet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("auth\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("context")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ./\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dockerfile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Dockerfile"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("auth\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("TZ")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Asia/Shanghai\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 9010"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9010")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" D"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\\YH\\tmp\\toilet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("auth\\data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/opt/authority"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("data\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" toilet\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加内置hosts映射，application配置中的地址用映射域名")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("extra_hosts")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" toilet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("192.168.0.31\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("toilet-system")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" toilet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("system\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" toilet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("system\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("context")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ./\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dockerfile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Dockerfile"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("system\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("TZ")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Asia/Shanghai\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 9011"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9011")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" D"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\\YH\\tmp\\toilet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("system\\data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/var/www/data/upload\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" toilet\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("extra_hosts")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" toilet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("192.168.0.31\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("toilet-map")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" toilet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("map\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" toilet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("map\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("context")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ./\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dockerfile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Dockerfile"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("map\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("TZ")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Asia/Shanghai\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 9012"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9012")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" toilet\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("extra_hosts")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" toilet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("192.168.0.31\n      \n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#前端")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("toilet-web")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" toilet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("web\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" toilet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("web\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("context")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ./\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dockerfile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Dockerfile"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("web\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("TZ")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Asia/Shanghai\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 内部端口映射不用动，包括ngix的反向代理比如(http://toilet-auth:9010)")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 9013"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" toilet\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 依赖的服务启动后才启动")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" toilet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("gateway\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" toilet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("auth\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br")])]),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 同一网络下测试")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it toilet-web "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" toilet-gateway\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);